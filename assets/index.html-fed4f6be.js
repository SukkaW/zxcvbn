import{_ as t,M as o,p as c,q as i,Q as a,t as n,N as s,a1 as r}from"./framework-9e042e77.js";const p={},d=a("h1",{id:"matcher",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#matcher","aria-hidden":"true"},"#"),n(" Matcher")],-1),l={href:"https://www.npmjs.com/package/@zxcvbn-ts/matcher-pwned",target:"_blank",rel:"noopener noreferrer"},u=r(`<h2 id="built-in-matchers" tabindex="-1"><a class="header-anchor" href="#built-in-matchers" aria-hidden="true">#</a> Built-in Matchers</h2><p>There are several built-in matchers available:</p><h3 id="bruteforce" tabindex="-1"><a class="header-anchor" href="#bruteforce" aria-hidden="true">#</a> Bruteforce</h3><p>The bruteforce matcher is used to determine if a password can be guessed by brute force. This will be the last matcher used when evaluating password strength.</p><h3 id="date" tabindex="-1"><a class="header-anchor" href="#date" aria-hidden="true">#</a> Date</h3><p>The date matcher searches for dates in the format YYYY-MM-DD or dates without separators.</p><h3 id="dictionary" tabindex="-1"><a class="header-anchor" href="#dictionary" aria-hidden="true">#</a> Dictionary</h3><p>The dictionary matcher attempts to find a word inside one of the provided dictionaries. There are multiple variants of this matcher:</p><ol><li>Plain: searches for the exact word in the dictionaries</li><li>Reverse: reverses the password and searches the dictionaries</li><li>L33t: transforms l33t speak to normal characters and searches the dictionaries. This includes transforming extended l33t speak like |_| =&gt; u.</li><li>Diceware: If the password is found in the diceware dictionary, a fixed score is assigned to this finding.</li></ol><h3 id="regex" tabindex="-1"><a class="header-anchor" href="#regex" aria-hidden="true">#</a> Regex</h3><p>The regex matcher searches for a string using a regex pattern. Currently, it only searches for recent years.</p><h3 id="repeat" tabindex="-1"><a class="header-anchor" href="#repeat" aria-hidden="true">#</a> Repeat</h3><p>The repeat matcher searches for repeated patterns like aaaaaaa or byebyebye.</p><h3 id="sequence" tabindex="-1"><a class="header-anchor" href="#sequence" aria-hidden="true">#</a> Sequence</h3><p>The sequence matcher identifies sequences by looking for repeated differences in Unicode codepoints, for example, abcdef or 1234567.</p><h3 id="spatial" tabindex="-1"><a class="header-anchor" href="#spatial" aria-hidden="true">#</a> Spatial</h3><p>The spatial matcher searches for patterns based on keyboard layout, for example, qwertz.</p><h2 id="custom-matcher" tabindex="-1"><a class="header-anchor" href="#custom-matcher" aria-hidden="true">#</a> Custom Matcher</h2><p>Custom matchers can be created if needed, including asynchronous matchers. If creating an asynchronous matcher, the function should be debounced using the included debounce function.</p><h3 id="creating-a-custom-matcher" tabindex="-1"><a class="header-anchor" href="#creating-a-custom-matcher" aria-hidden="true">#</a> Creating a Custom Matcher</h3><p>Here is an example of how to create a custom matcher to check for minimum password length. Please note that we do not recommend using a minimum length matcher.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> zxcvbnOptions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@zxcvbn-ts/core&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  MatchEstimated<span class="token punctuation">,</span>
  ExtendedMatch<span class="token punctuation">,</span>
  Matcher<span class="token punctuation">,</span>
  Match<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@zxcvbn-ts/core/dist/types&#39;</span>

<span class="token keyword">const</span> minLengthMatcher<span class="token operator">:</span> Matcher <span class="token operator">=</span> <span class="token punctuation">{</span>
  Matching<span class="token operator">:</span> <span class="token keyword">class</span> <span class="token class-name">MatchMinLength</span> <span class="token punctuation">{</span>
    minLength <span class="token operator">=</span> <span class="token number">10</span>

    <span class="token function">match</span><span class="token punctuation">(</span><span class="token punctuation">{</span> password <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> password<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> matches<span class="token operator">:</span> Match<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>password<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>minLength<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        matches<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          pattern<span class="token operator">:</span> <span class="token string">&#39;minLength&#39;</span><span class="token punctuation">,</span>
          token<span class="token operator">:</span> password<span class="token punctuation">,</span>
          i<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          j<span class="token operator">:</span> password<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> matches
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">feedback</span><span class="token punctuation">(</span>match<span class="token operator">:</span> MatchEstimated<span class="token punctuation">,</span> isSoleMatch<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      warning<span class="token operator">:</span> <span class="token string">&#39;Your password is not long enough&#39;</span><span class="token punctuation">,</span>
      suggestions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">scoring</span><span class="token punctuation">(</span>match<span class="token operator">:</span> ExtendedMatch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The length of the password is multiplied by 10 to create a higher score the more characters are added.</span>
    <span class="token keyword">return</span> match<span class="token punctuation">.</span>token<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">10</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

zxcvbnOptions<span class="token punctuation">.</span><span class="token function">addMatcher</span><span class="token punctuation">(</span><span class="token string">&#39;minLength&#39;</span><span class="token punctuation">,</span> minLengthMatcher<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The Matching function needs to return an array of matched tokens. The four default properties (pattern, token, i, and j) are mandatory but the object can be extended as needed. <code>pattern</code> is the name of the matcher that found the token <code>token</code> is the part of the password was found with the matcher <code>i</code> is the start index of the token inside the password <code>j</code> is the end index of the token inside the password</p><p>For example, if the repeat matcher found the following string: suchARandomRandomPassword, the result would be:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>i = 5
j = 16
token = RandomRandom
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The found token starts at character 5 and ends at character 16.</p><p>The scoring function takes the array of matches that you returned in the matching function as input and should return a guess count, which represents how many guesses an attacker would need to make to correctly guess the password. The guess count should be based on the strength of the password and the matches found. If you need any additional data to calculate your scoring, feel free to add it to the Match object in the matching function.</p><p>The feedback function takes a single Match object as input and should return a Feedback object that provides feedback to the user about the match. The Feedback object can have a warning and multiple suggestions.</p><h2 id="matcher-libraries" tabindex="-1"><a class="header-anchor" href="#matcher-libraries" aria-hidden="true">#</a> Matcher libraries</h2><p>There are different matcher libraries that can extend the core matchers. One such library is:</p><h3 id="zxcvbn-ts-matcher-pwned" tabindex="-1"><a class="header-anchor" href="#zxcvbn-ts-matcher-pwned" aria-hidden="true">#</a> @zxcvbn-ts/matcher-pwned</h3>`,31),h={href:"https://haveibeenpwned.com/",target:"_blank",rel:"noopener noreferrer"},m=a("p",null,"If you bind zxcvbn-ts to your input field and execute the function on every new character typed, be sure to use the provided debounce function to avoid making too many API requests.",-1);function k(b,v){const e=o("ExternalLinkIcon");return c(),i("div",null,[d,a("p",null,[n("The @zxcvbn-ts/core library provides built-in matchers to evaluate the strength of a password. Custom matchers can also be created, including asynchronous matchers such as the pwned-matcher which can be found in the "),a("a",l,[n("@zxcvbn-ts/matcher-pwned"),s(e)]),n(" library. When using an asynchronous custom matcher, the zxcvbnAsync function should be used.")]),u,a("p",null,[n("The pwned matcher is an async matcher that makes a k-anonymity password request to the "),a("a",h,[n("have i been pwned"),s(e)]),n(" API to check if the password has been exposed in a data breach.")]),m])}const g=t(p,[["render",k],["__file","index.html.vue"]]);export{g as default};
